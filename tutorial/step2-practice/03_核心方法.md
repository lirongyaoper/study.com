# ç¬¬ä¸‰ç« ï¼šTreeç±»æ ¸å¿ƒæ–¹æ³•è¯¦è§£ ğŸ”§

## æ–¹æ³•æ¦‚è§ˆ

SimpleTreeç±»æä¾›äº†ä»¥ä¸‹æ ¸å¿ƒæ–¹æ³•æ¥å¤„ç†æ ‘å½¢æ•°æ®ï¼š

| æ–¹æ³•å | åŠŸèƒ½ | éš¾åº¦ |
|--------|------|------|
| `init()` | åˆå§‹åŒ–æ•°æ® | â­ |
| `getChildren()` | è·å–å­èŠ‚ç‚¹ | â­ |
| `getParent()` | è·å–çˆ¶èŠ‚ç‚¹ | â­ |
| `getAllDescendants()` | è·å–æ‰€æœ‰å­å­™èŠ‚ç‚¹ | â­â­ |
| `generateTreeText()` | ç”Ÿæˆæ ‘å½¢æ–‡æœ¬ | â­â­â­ |
| `isLeaf()` | åˆ¤æ–­æ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹ | â­ |
| `getRoots()` | è·å–æ ¹èŠ‚ç‚¹ | â­ |
| `getDepth()` | è®¡ç®—èŠ‚ç‚¹æ·±åº¦ | â­â­ |

## 1. init() - æ•°æ®åˆå§‹åŒ– â­

### åŠŸèƒ½è¯´æ˜
è®¾ç½®Treeç±»è¦å¤„ç†çš„æ•°æ®ï¼Œè¿™æ˜¯ä½¿ç”¨Treeç±»çš„ç¬¬ä¸€æ­¥ã€‚

### è¯­æ³•
```php
public function init($data = array())
```

### å‚æ•°
- `$data` (array): æ ‘å½¢æ•°æ®çš„äºŒç»´æ•°ç»„

### è¿”å›å€¼
- `boolean`: æˆåŠŸè¿”å›trueï¼Œå¤±è´¥è¿”å›false

### ä½¿ç”¨ç¤ºä¾‹
```php
$tree = new SimpleTree();

// å‡†å¤‡æ•°æ®
$data = array(
    1 => array('id' => 1, 'parentid' => 0, 'name' => 'æ ¹èŠ‚ç‚¹'),
    2 => array('id' => 2, 'parentid' => 1, 'name' => 'å­èŠ‚ç‚¹')
);

// åˆå§‹åŒ–
$result = $tree->init($data);
if ($result) {
    echo "æ•°æ®åˆå§‹åŒ–æˆåŠŸï¼";
} else {
    echo "æ•°æ®åˆå§‹åŒ–å¤±è´¥ï¼";
}
```

### æ³¨æ„äº‹é¡¹
- æ•°æ®å¿…é¡»æ˜¯æ•°ç»„æ ¼å¼
- æ¯ä¸ªæ•°ç»„å…ƒç´ å¿…é¡»åŒ…å«`id`å’Œ`parentid`å­—æ®µ
- å»ºè®®åœ¨ä½¿ç”¨å…¶ä»–æ–¹æ³•å‰å…ˆè°ƒç”¨æ­¤æ–¹æ³•

---

## 2. getChildren() - è·å–å­èŠ‚ç‚¹ â­

### åŠŸèƒ½è¯´æ˜
è·å–æŒ‡å®šèŠ‚ç‚¹çš„æ‰€æœ‰ç›´æ¥å­èŠ‚ç‚¹ï¼Œè¿™æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ä¹‹ä¸€ã€‚

### è¯­æ³•
```php
public function getChildren($parent_id)
```

### å‚æ•°
- `$parent_id` (int): çˆ¶èŠ‚ç‚¹çš„ID

### è¿”å›å€¼
- `array`: å­èŠ‚ç‚¹æ•°ç»„ï¼ˆå¦‚æœæœ‰å­èŠ‚ç‚¹ï¼‰
- `false`: æ²¡æœ‰å­èŠ‚ç‚¹æ—¶è¿”å›false

### ä½¿ç”¨ç¤ºä¾‹
```php
// è·å–IDä¸º1çš„èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹
$children = $tree->getChildren(1);

if ($children) {
    echo "æ‰¾åˆ° " . count($children) . " ä¸ªå­èŠ‚ç‚¹ï¼š\n";
    foreach ($children as $child) {
        echo "- " . $child['name'] . "\n";
    }
} else {
    echo "æ²¡æœ‰æ‰¾åˆ°å­èŠ‚ç‚¹\n";
}
```

### å®é™…åº”ç”¨
```php
// ç”Ÿæˆä¸‹æ‹‰èœå•é€‰é¡¹
function generateOptions($tree, $parent_id) {
    $html = '';
    $children = $tree->getChildren($parent_id);
    
    if ($children) {
        foreach ($children as $child) {
            $html .= "<option value='{$child['id']}'>{$child['name']}</option>\n";
        }
    }
    
    return $html;
}
```

---

## 3. getParent() - è·å–çˆ¶èŠ‚ç‚¹ â­

### åŠŸèƒ½è¯´æ˜
è·å–æŒ‡å®šèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ä¿¡æ¯ã€‚

### è¯­æ³•
```php
public function getParent($node_id)
```

### å‚æ•°
- `$node_id` (int): èŠ‚ç‚¹ID

### è¿”å›å€¼
- `array`: çˆ¶èŠ‚ç‚¹ä¿¡æ¯ï¼ˆå¦‚æœæœ‰çˆ¶èŠ‚ç‚¹ï¼‰
- `false`: æ˜¯æ ¹èŠ‚ç‚¹æˆ–èŠ‚ç‚¹ä¸å­˜åœ¨æ—¶è¿”å›false

### ä½¿ç”¨ç¤ºä¾‹
```php
// è·å–IDä¸º4çš„èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹
$parent = $tree->getParent(4);

if ($parent) {
    echo "çˆ¶èŠ‚ç‚¹æ˜¯: " . $parent['name'];
} else {
    echo "è¿™æ˜¯æ ¹èŠ‚ç‚¹æˆ–èŠ‚ç‚¹ä¸å­˜åœ¨";
}
```

### å®é™…åº”ç”¨
```php
// ç”Ÿæˆé¢åŒ…å±‘å¯¼èˆª
function generateBreadcrumb($tree, $node_id) {
    $path = array();
    $current_id = $node_id;
    
    // å‘ä¸Šè¿½æº¯åˆ°æ ¹èŠ‚ç‚¹
    while ($current_id != 0) {
        if (isset($tree->data[$current_id])) {
            array_unshift($path, $tree->data[$current_id]);
            $current_id = $tree->data[$current_id]['parentid'];
        } else {
            break;
        }
    }
    
    return $path;
}
```

---

## 4. getAllDescendants() - è·å–æ‰€æœ‰å­å­™èŠ‚ç‚¹ â­â­

### åŠŸèƒ½è¯´æ˜
é€’å½’è·å–æŒ‡å®šèŠ‚ç‚¹ä¸‹çš„æ‰€æœ‰å­å­™èŠ‚ç‚¹ï¼ˆä¸ä»…ä»…æ˜¯ç›´æ¥å­èŠ‚ç‚¹ï¼‰ã€‚

### è¯­æ³•
```php
public function getAllDescendants($parent_id)
```

### å‚æ•°
- `$parent_id` (int): çˆ¶èŠ‚ç‚¹ID

### è¿”å›å€¼
- `array`: æ‰€æœ‰å­å­™èŠ‚ç‚¹çš„æ•°ç»„

### é€’å½’åŸç†å›¾è§£
```
getAllDescendants(1) çš„æ‰§è¡Œè¿‡ç¨‹ï¼š

1. è·å–èŠ‚ç‚¹1çš„ç›´æ¥å­èŠ‚ç‚¹: [2, 3]
2. å¤„ç†èŠ‚ç‚¹2:
   - æ·»åŠ èŠ‚ç‚¹2åˆ°ç»“æœ
   - é€’å½’è°ƒç”¨ getAllDescendants(2)
   - è·å–èŠ‚ç‚¹2çš„å­èŠ‚ç‚¹: [4, 5]
   - æ·»åŠ èŠ‚ç‚¹4, 5åˆ°ç»“æœ
3. å¤„ç†èŠ‚ç‚¹3:
   - æ·»åŠ èŠ‚ç‚¹3åˆ°ç»“æœ
   - é€’å½’è°ƒç”¨ getAllDescendants(3)
   - è·å–èŠ‚ç‚¹3çš„å­èŠ‚ç‚¹: [6]
   - æ·»åŠ èŠ‚ç‚¹6åˆ°ç»“æœ

æœ€ç»ˆç»“æœ: [2, 4, 5, 3, 6]
```

### ä½¿ç”¨ç¤ºä¾‹
```php
// è·å–æ‰€æœ‰å­å­™èŠ‚ç‚¹
$descendants = $tree->getAllDescendants(1);

echo "èŠ‚ç‚¹1çš„æ‰€æœ‰å­å­™èŠ‚ç‚¹ï¼š\n";
foreach ($descendants as $node) {
    echo "- " . $node['name'] . "\n";
}
```

### å®é™…åº”ç”¨
```php
// åˆ é™¤åˆ†ç±»æ—¶ï¼ŒåŒæ—¶åˆ é™¤æ‰€æœ‰å­åˆ†ç±»
function deleteCategory($tree, $category_id) {
    $to_delete = array($category_id);
    
    // è·å–æ‰€æœ‰å­å­™èŠ‚ç‚¹ID
    $descendants = $tree->getAllDescendants($category_id);
    foreach ($descendants as $descendant) {
        $to_delete[] = $descendant['id'];
    }
    
    // æ‰¹é‡åˆ é™¤
    foreach ($to_delete as $id) {
        // æ‰§è¡Œåˆ é™¤æ“ä½œ
        echo "åˆ é™¤åˆ†ç±» ID: $id\n";
    }
}
```

---

## 5. generateTreeText() - ç”Ÿæˆæ ‘å½¢æ–‡æœ¬ â­â­â­

### åŠŸèƒ½è¯´æ˜
ç”Ÿæˆç¾è§‚çš„æ ‘å½¢æ–‡æœ¬ç»“æ„ï¼Œç”¨äºåœ¨æ§åˆ¶å°æˆ–ç½‘é¡µä¸Šæ˜¾ç¤ºã€‚

### è¯­æ³•
```php
public function generateTreeText($parent_id = 0, $prefix = '')
```

### å‚æ•°
- `$parent_id` (int): èµ·å§‹èŠ‚ç‚¹IDï¼ˆé»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼‰
- `$prefix` (string): å‰ç¼€å­—ç¬¦ä¸²ï¼ˆé€’å½’ä½¿ç”¨ï¼Œå¤–éƒ¨è°ƒç”¨æ—¶ä¸éœ€è¦è®¾ç½®ï¼‰

### è¿”å›å€¼
- `string`: æ ¼å¼åŒ–çš„æ ‘å½¢æ–‡æœ¬å­—ç¬¦ä¸²

### è¾“å‡ºæ ¼å¼è¯´æ˜
```
ç”µå­äº§å“
â”œâ”€â”€ æ‰‹æœº
â”‚   â”œâ”€â”€ iPhone
â”‚   â””â”€â”€ åä¸ºæ‰‹æœº
â””â”€â”€ ç”µè„‘
    â”œâ”€â”€ ç¬”è®°æœ¬ç”µè„‘
    â””â”€â”€ å°å¼ç”µè„‘
```

**ç¬¦å·è¯´æ˜ï¼š**
- `â”œâ”€â”€`: è¡¨ç¤ºæœ‰å…„å¼ŸèŠ‚ç‚¹çš„å­èŠ‚ç‚¹
- `â””â”€â”€`: è¡¨ç¤ºæœ€åä¸€ä¸ªå­èŠ‚ç‚¹
- `â”‚`: è¡¨ç¤ºä¸Šçº§è¿˜æœ‰å…„å¼ŸèŠ‚ç‚¹ï¼Œéœ€è¦è¿æ¥çº¿
- `ç©ºæ ¼`: è¡¨ç¤ºä¸Šçº§æ²¡æœ‰å…„å¼ŸèŠ‚ç‚¹äº†

### ä½¿ç”¨ç¤ºä¾‹
```php
// ç”Ÿæˆå®Œæ•´çš„æ ‘å½¢ç»“æ„
echo $tree->generateTreeText();

// ä»æŒ‡å®šèŠ‚ç‚¹å¼€å§‹ç”Ÿæˆ
echo "æ‰‹æœºåˆ†ç±»ä¸‹çš„ç»“æ„ï¼š\n";
echo $tree->generateTreeText(2);
```

### ç®—æ³•åŸç†
```php
// ç®€åŒ–çš„ç®—æ³•é€»è¾‘
function generateTreeText($parent_id, $prefix) {
    $children = getChildren($parent_id);
    $result = '';
    
    for ($i = 0; $i < count($children); $i++) {
        $child = $children[$i];
        $is_last = ($i == count($children) - 1);
        
        if ($is_last) {
            $current_prefix = $prefix . 'â””â”€â”€ ';
            $next_prefix = $prefix . '    ';  // ç©ºæ ¼ï¼Œå› ä¸ºæ˜¯æœ€åä¸€ä¸ª
        } else {
            $current_prefix = $prefix . 'â”œâ”€â”€ ';
            $next_prefix = $prefix . 'â”‚   ';  // ç«–çº¿ï¼Œè¿˜æœ‰å…„å¼ŸèŠ‚ç‚¹
        }
        
        $result .= $current_prefix . $child['name'] . "\n";
        $result .= generateTreeText($child['id'], $next_prefix);
    }
    
    return $result;
}
```

---

## 6. è¾…åŠ©æ–¹æ³•è¯¦è§£

### isLeaf() - åˆ¤æ–­å¶å­èŠ‚ç‚¹
```php
// æ£€æŸ¥èŠ‚ç‚¹æ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹
if ($tree->isLeaf(4)) {
    echo "è¿™æ˜¯å¶å­èŠ‚ç‚¹ï¼Œå¯ä»¥æ”¾ç½®å†…å®¹";
} else {
    echo "è¿™æ˜¯åˆ†æ”¯èŠ‚ç‚¹ï¼ŒåŒ…å«å­èŠ‚ç‚¹";
}
```

### getRoots() - è·å–æ ¹èŠ‚ç‚¹
```php
// è·å–æ‰€æœ‰æ ¹èŠ‚ç‚¹
$roots = $tree->getRoots();
foreach ($roots as $root) {
    echo "æ ¹èŠ‚ç‚¹: " . $root['name'] . "\n";
}
```

### getDepth() - è®¡ç®—æ·±åº¦
```php
// è®¡ç®—èŠ‚ç‚¹æ·±åº¦ï¼ˆç”¨äºç¼©è¿›æ§åˆ¶ï¼‰
$depth = $tree->getDepth(4);
$indent = str_repeat('  ', $depth - 1);
echo $indent . "èŠ‚ç‚¹åç§°";
```

## å®è·µå»ºè®®

1. **ä»ç®€å•å¼€å§‹**ï¼šå…ˆæŒæ¡`getChildren()`å’Œ`getParent()`
2. **ç†è§£é€’å½’**ï¼šé‡ç‚¹ç†è§£`getAllDescendants()`çš„é€’å½’é€»è¾‘
3. **è°ƒè¯•æŠ€å·§**ï¼šä½¿ç”¨`printData()`æ–¹æ³•æŸ¥çœ‹æ•°æ®ç»“æ„
4. **å®é™…åº”ç”¨**ï¼šç»“åˆå…·ä½“åœºæ™¯ç»ƒä¹ è¿™äº›æ–¹æ³•

## ä¸‹ä¸€æ­¥å­¦ä¹ 

ç°åœ¨ä½ å·²ç»äº†è§£äº†æ‰€æœ‰æ ¸å¿ƒæ–¹æ³•ï¼Œæ¥ä¸‹æ¥ï¼š
1. è¿è¡Œ `examples/basic_usage.php` æŸ¥çœ‹å®é™…ä½¿ç”¨
2. å®Œæˆ `exercises/exercise_01.php` ç»ƒä¹ 
3. é˜…è¯» [`04_å®æˆ˜åº”ç”¨.md`](04_å®æˆ˜åº”ç”¨.md) äº†è§£æ›´å¤šåº”ç”¨åœºæ™¯

ç»§ç»­ä½ çš„Treeç±»å­¦ä¹ ä¹‹æ—…ï¼ğŸš€
